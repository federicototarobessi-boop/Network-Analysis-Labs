Nmap: Advanced Port Scans

Activity description: This activity focused on advanced network scanning techniques used to bypass firewalls and IDS/IPS systems. I explored specialized TCP scans, such as Null, FIN, Xmas, and Idle scans, to identify open ports when standard scanning methods are blocked or logged. The lab also covered packet fragmentation and the use of specific Nmap flags to analyze how different network security devices respond to non-standard traffic patterns.

Tools used: Nmap (Network Mapper); Linux Terminal (Attack box), Target VM (TryHackMe Lab Environment)

Methodology:
1.	TCP Null Scan, FIN Scan, and Xmas Scan – In the three cases, we cannot be certain if a port is open or just filtered. However, if the port is closed, we will receive a “RST” packet in response.
2.	TCP Maimon Scan - In this scan, the FIN and ACK bits are set. The target should send an RST packet as a response.
3.	TCP ACK, Window, and Custom Scan – In TCP ACK Scan (-sA), since an ACK packet is sent, only a RST packet will be sent in response, which does not tell us whether the target port is open. This kind of scan is useful to investigate which ports were not blocked by the firewall. TCP Window scan (-sW) works pretty much in the same way, but in return you get that the ports are “closed”, meaning that the firewall does not block them. I also learned that just because a firewall is not blocking a specific port, it does not necessarily mean that a service is listening on that port.
4.	Fragmented Packets – In order to escape firewall/IDS detection, it is possible to divide your packets into smaller packets. You can do that by using the option “-f” and the IP data will be divided into 8 bytes or less. Adding another f will split the data into 16-byte fragments instead of 8.
5.	Idle/Zombie Scan - The idle scan, or zombie scan, requires an idle system connected to the network that you can communicate with. Practically, Nmap will make each probe appear as if coming from the idle (zombie) host, then it will check for indicators whether the idle (zombie) host received any response to the spoofed probe. This is accomplished by checking the IP identification (IP ID) value in the IP header.
6.	“-- reason” flag - Providing the “—reason” flag gives us the explicit reason why Nmap concluded that the system is up or a particular port is open. For more detailed output, we can consider using “-v” for verbose output or “-vv” for even more verbosity.

Lessons Learned: I learned that advanced scans like Null, FIN, and Xmas can help identify port states by observing the lack of response or the return of RST packets. I understood the importance of packet fragmentation for stealth and how the Idle scan allows for completely anonymous probing by using a zombie host. Additionally, I learned that while a firewall may permit traffic through a port, it does not always mean a service is active on that port.

